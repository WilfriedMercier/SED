

<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>LePhare tutorial &mdash; Resolved SED-fitting wrapper 0.5 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Cigale tutorial" href="cigale.html" />
    <link rel="prev" title="Tutorial introduction" href="index.html" /> 

</head>

<body>
    <header>
        <div class="container">
            <a class="site-nav-toggle hidden-lg-up"><i class="icon-menu"></i></a>
            <a class="site-title" href="../index.html">
                Resolved SED-fitting wrapper
            </a>
        </div>
    </header>


<div class="breadcrumbs-outer hidden-xs-down">
    <div class="container">
        















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="breadcrumbs">
    
      <li><a href="../index.html">Docs</a></li>
        
          <li><a href="index.html">Tutorial introduction</a></li>
        
      <li>LePhare tutorial</li>
    
    
      <li class="breadcrumbs-aside">
        
            
            <a href="../_sources/tutorial/lephare.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
</div>
    </div>
</div>
    <div class="main-outer">
        <div class="container">
            <div class="row">
                <div class="col-12 col-lg-3 site-nav">
                    
<div role="search">
    <form class="search" action="../search.html" method="get">
        <div class="icon-input">
            <input type="text" name="q" placeholder="Search" />
            <span class="icon-search"></span>
        </div>
        <input type="submit" value="Go" class="d-hidden" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div>
                    <div class="site-nav-tree">
                        
                            
                            
                                <ul>
<li class="toctree-l1"><a class="reference internal" href="../setup.html">Installation and setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../setup.html#required-dependencies">Required dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup.html#sed-fitting-codes-installation">SED fitting codes installation</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorial introduction</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">LePhare</a></li>
<li class="toctree-l2"><a class="reference internal" href="cigale.html">Cigale</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#nomenclature">Nomenclature</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#pre-processing-step">Pre-processing step</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#step-1-building-filter-and-filterlist-objects">Step 1: Building <code class="xref py py-class docutils literal notranslate"><span class="pre">Filter</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">FilterList</span></code> objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#step-2-generate-a-catalogue-object">Step 2: Generate a <code class="xref py py-class docutils literal notranslate"><span class="pre">Catalogue</span></code> object</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#step-3-create-a-sed-object">Step 3: Create a <code class="xref py py-class docutils literal notranslate"><span class="pre">SED</span></code> object</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#step-4-run-the-sed-fitting">Step 4: Run the SED fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#step-5-produce-a-resolved-map">Step 5: Produce a resolved map</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/example1.html">1. Generate a LePhare configuration file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/example2.html">2. Resolved stellar mass map with LePhare</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/example3.html">3. Resolved SFR map from an already existing LePhare output file</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">----------------------------------------</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../API/index.html">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../API/catalogues.html">Catalogue classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API/filters.html">Filter classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API/misc/index.html">Miscellaneous</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API/outputs.html">SED fitting code output classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API/sed.html">SED classes</a></li>
</ul>
</li>
</ul>

                            
                        
                    </div>
                </div>
                <div class="col-12 col-lg-9">
                    <div class="document">
                        
                            
  <section id="lephare-tutorial">
<h1>LePhare tutorial<a class="headerlink" href="#lephare-tutorial" title="Permalink to this headline">¶</a></h1>
<p>This tutorial is specific to using LePhare SED fitting code.</p>
<section id="step-1-building-filter-and-filterlist-objects">
<h2>Step 1: Building <a class="reference internal" href="../API/filters.html#SED.filters.Filter" title="SED.filters.Filter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Filter</span></code></a> and <a class="reference internal" href="../API/filters.html#SED.filters.FilterList" title="SED.filters.FilterList"><code class="xref py py-class docutils literal notranslate"><span class="pre">FilterList</span></code></a> objects<a class="headerlink" href="#step-1-building-filter-and-filterlist-objects" title="Permalink to this headline">¶</a></h2>
<p>Creating <a class="reference internal" href="../API/filters.html#SED.filters.Filter" title="SED.filters.Filter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Filter</span></code></a> and <a class="reference internal" href="../API/filters.html#SED.filters.FilterList" title="SED.filters.FilterList"><code class="xref py py-class docutils literal notranslate"><span class="pre">FilterList</span></code></a> objects for Lephare is similar to the general example. When creating the <a class="reference internal" href="../API/filters.html#SED.filters.FilterList" title="SED.filters.FilterList"><code class="xref py py-class docutils literal notranslate"><span class="pre">FilterList</span></code></a>, the following actions are performed:</p>
<ol class="arabic simple">
<li><p>Mask bad pixels (including masked pixels and those with negative flux values)</p></li>
<li><p>Add Poisson noise to the variance map</p></li>
<li><p>Compute a mean 2D map (spectral average)</p></li>
<li><p>Scale data dividing by the mean map and multiplying by a scale factor. This ensures the input magnitudes in LePhare have the correct order of magnitude for every pixel.</p></li>
<li><p>Map data and variance maps to 1D arrays</p></li>
<li><p>Compute std (square root of variance) map</p></li>
<li><p>Convert data and std maps into magnitudes</p></li>
<li><p>Generate additional columns for LePhare</p></li>
</ol>
<p>If needed, the astropy Table can easily be retrieved as follows</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">flist</span><span class="o">.</span><span class="n">table</span>
</pre></div>
</div>
<p>There are a few options one can change to get a different data processing, update the table and also return it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">newTable</span> <span class="o">=</span> <span class="n">flist</span><span class="o">.</span><span class="n">toTable</span><span class="p">(</span><span class="n">cleanMethod</span><span class="o">=</span><span class="n">CleanMethod</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span> <span class="n">scaleFactor</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">texpFac</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>The different options are:</p>
<ul class="simple">
<li><p><strong>cleanMethod</strong>: CleanMethod.ZERO (to put 0 if data is in flux unit or -99 if in magnitude on bad pixels) or CleanMethod.MIN (to put the minimum value of the good pixels on bad pixels)</p></li>
<li><p><strong>scaleFactor</strong>: Factor by which to multiply the data and std maps when scaling with the mean map</p></li>
<li><p><strong>texpFac</strong>: Exposure time factor which divides the exposure time found in the header of the data. This is only used if a Poisson noise is added to the data. If 0, no Poisson noise is added.</p></li>
</ul>
<p>Optionally, one can also pass these arguments when setting a new code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">flist</span><span class="o">.</span><span class="n">setCode</span><span class="p">(</span><span class="n">SED</span><span class="o">.</span><span class="n">SEDcode</span><span class="o">.</span><span class="n">LEPHARE</span><span class="p">,</span> <span class="n">cleanMethod</span><span class="o">=</span><span class="n">CleanMethod</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span> <span class="n">scaleFactor</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">texpFac</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="step-2-generate-a-lepharecat-object">
<h2>Step 2: Generate a <a class="reference internal" href="../API/catalogues.html#SED.catalogues.LePhareCat" title="SED.catalogues.LePhareCat"><code class="xref py py-class docutils literal notranslate"><span class="pre">LePhareCat</span></code></a> object<a class="headerlink" href="#step-2-generate-a-lepharecat-object" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="../API/catalogues.html#SED.catalogues.LePhareCat" title="SED.catalogues.LePhareCat"><code class="xref py py-class docutils literal notranslate"><span class="pre">LePhareCat</span></code></a> object is used to easily save the input data to the correct format and write a formatted string used when generating LePhare parameter file. Assuming <code class="code docutils literal notranslate"><span class="pre">flist</span></code> is the <a class="reference internal" href="../API/filters.html#SED.filters.FilterList" title="SED.filters.FilterList"><code class="xref py py-class docutils literal notranslate"><span class="pre">FilterList</span></code></a> object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gal</span>        <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
<span class="n">catalogue</span>  <span class="o">=</span> <span class="n">flist</span><span class="o">.</span><span class="n">toCatalogue</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">gal</span><span class="si">}</span><span class="s1">.in&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The first parameter is the name of the file where the catalogue will be saved. Optional parameters can be passed:</p>
<ul class="simple">
<li><p><strong>tunit</strong>: TableUnit.MAG (data in magnitude) or TableUnit.FLUX (data in flux values)</p></li>
<li><p><strong>magtype</strong>: MagType.AB (AB magnitudes) or SED.MagType.VEGA (VEGA magnitudes)</p></li>
<li><p><strong>tformat</strong>: TableFormat.MEME (data and error columns intertwined), TableFormat.MMMEE (data and then error columns)</p></li>
<li><p><strong>ttype</strong>: TableType.LONG or TableType.SHORT</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>tunit</strong>, <strong>magtype</strong>, <strong>tformat</strong> and <strong>ttype</strong> keyword arguments default values are sufficient when using <a class="reference internal" href="../API/filters.html#SED.filters.FilterList.toCatalogue" title="SED.filters.FilterList.toCatalogue"><code class="xref py py-meth docutils literal notranslate"><span class="pre">toCatalogue()</span></code></a> method.</p>
<p>If needed, only modify them if you create your own <a class="reference internal" href="../API/catalogues.html#SED.catalogues.LePhareCat" title="SED.catalogues.LePhareCat"><code class="xref py py-class docutils literal notranslate"><span class="pre">LePhareCat</span></code></a> through the <a class="reference internal" href="../API/catalogues.html#SED.catalogues.LePhareCat.__init__" title="SED.catalogues.LePhareCat.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a> method.</p>
</div>
</section>
<section id="step-3-create-a-lepharesed-object">
<h2>Step 3: Create a <a class="reference internal" href="../API/sed.html#SED.sed.LePhareSED" title="SED.sed.LePhareSED"><code class="xref py py-class docutils literal notranslate"><span class="pre">LePhareSED</span></code></a> object<a class="headerlink" href="#step-3-create-a-lepharesed-object" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">prop</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;FILTER_LIST&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;HST_ACS_WFC.F435W&#39;</span><span class="p">,</span> <span class="s1">&#39;HST_ACS_WFC.F606W&#39;</span><span class="p">,</span> <span class="s1">&#39;HST_ACS_WFC.F775W&#39;</span><span class="p">],</span>
        <span class="s1">&#39;ERR_SCALE&#39;</span>   <span class="p">:</span> <span class="p">[</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">]</span>
       <span class="p">}</span>

<span class="n">sed</span>  <span class="o">=</span> <span class="n">SED</span><span class="o">.</span><span class="n">LePhareSED</span><span class="p">(</span><span class="s1">&#39;Gal1&#39;</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="n">prop</span><span class="p">)</span>
</pre></div>
</div>
<p>The first parameter is the name of the object. This is used to name the associated files and directories. The second parameter is a dictionary where the user can provide all the different SED parameters for LePhare. We give a brief list of the most useful ones below:</p>
<ul class="simple">
<li><p><strong>STAR_SED</strong> [str]: stellar library list file (full path)</p></li>
<li><p><strong>QSO_SED</strong> [str]: QSO list file (full path)</p></li>
<li><p><strong>GAL_SED</strong> [str]: galaxy library list file (full path)</p></li>
<li><p><strong>AGE_RANGE</strong> [list[float]]: minimum and maximum ages in years</p></li>
<li><p><strong>FILTER_LIST</strong> [list[str]]: list of filter names used for the fit (must all be located in $LEPHAREDIR/filt directory)</p></li>
<li><p><strong>Z_STEP</strong> [list[int/float]]: redshift step properties. Values are: redshift step, max redshift, redshift step for redshifts above 6 (coarser sampling).</p></li>
<li><p><strong>COSMOLOGY</strong> [list[int/float]]: cosmology parameters. Values are: Hubble constant H0, baryon fraction Omegam0, cosmological constant fraction Omegalambda0.</p></li>
<li><p><strong>MOD_EXTINC</strong> [list[int/float]]: minimum and maximum model extinctions</p></li>
<li><p><strong>EXTINC_LAW</strong> [str]: extinction law file (in $LEPHAREDIR/ext)</p></li>
<li><p><strong>EB_V</strong> [list[int/float]]: color excess E(B-V). It must contain less than 50 values.</p></li>
<li><p><strong>EM_LINES</strong> [str]: whether to consider emission lines or not. Accepted values are ‘YES’ or ‘NO’.</p></li>
<li><p><strong>ERR_SCALE</strong> [list[int/float]]: magnitude errors per band to add in quadrature</p></li>
<li><p><strong>ERR_FACTOR</strong> [int/float]: scaling factor to apply to the errors</p></li>
<li><p><strong>ZPHOTLIB</strong> [list[str]]: librairies used to compute the Chi2. Maximum number is 3.</p></li>
<li><p><strong>ADD_EMLINES</strong> [str]: whether to add emission lines or not (dupplicate with <strong>EM_LINES</strong> ?). Accepted values are ‘YES’ or ‘NO’.</p></li>
</ul>
<p>For the complete list of options, see <a class="reference internal" href="../API/misc/enum.html#SED.misc.enum.LePhareOutputParam" title="SED.misc.enum.LePhareOutputParam"><code class="xref py py-class docutils literal notranslate"><span class="pre">LePhareOutputParam</span></code></a> values (upper case names).</p>
</section>
<section id="step-4-run-the-sed-fitting">
<h2>Step 4: Run the SED fitting<a class="headerlink" href="#step-4-run-the-sed-fitting" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="../API/sed.html#SED.sed.LePhareSED" title="SED.sed.LePhareSED"><code class="xref py py-class docutils literal notranslate"><span class="pre">LePhareSED</span></code></a> object can be directly called to run the SED fitting. In order to avoid to load all of LePhare parameters in the output file, a list of required parameter names (see <a class="reference internal" href="../API/misc/enum.html#SED.misc.enum.LePhareOutputParam" title="SED.misc.enum.LePhareOutputParam"><code class="xref py py-class docutils literal notranslate"><span class="pre">LePhareOutputParam</span></code></a> for accepted values) must be passed as follows</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MASS_INF&#39;</span><span class="p">,</span> <span class="s1">&#39;MASS_MED&#39;</span><span class="p">,</span> <span class="s1">&#39;MASS_SUP&#39;</span><span class="p">,</span> <span class="s1">&#39;SFR_INF&#39;</span><span class="p">,</span> <span class="s1">&#39;SFR_MED&#39;</span><span class="p">,</span> <span class="s1">&#39;SFR_SUP&#39;</span><span class="p">]</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">sed</span><span class="p">(</span><span class="n">catalogue</span><span class="p">,</span> <span class="n">outputParams</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<p>When running the code, the output parameter values are extracted from the output parameters file and are stored into a <a class="reference internal" href="../API/outputs.html#SED.outputs.LePhareOutput" title="SED.outputs.LePhareOutput"><code class="xref py py-class docutils literal notranslate"><span class="pre">LePhareOutput</span></code></a> object.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In order to perform the SED fitting, LePhare  generates a few files:</p>
<ul class="simple">
<li><p>file.in: Input catalogue containing data</p></li>
<li><p>file.para: Parameter files with all the SED fitting properties</p></li>
<li><p>file.out: Output data file</p></li>
<li><p>file._output_para: Output parameter for the various SED parameters</p></li>
</ul>
</div>
<p>The different values are stored in an Astropy table, with column names given by the <code class="code docutils literal notranslate"><span class="pre">.name</span></code> attribute of the <a class="reference internal" href="../API/misc/enum.html#SED.misc.enum.LePhareOutputParam" title="SED.misc.enum.LePhareOutputParam"><code class="xref py py-class docutils literal notranslate"><span class="pre">LePhareOutputParam</span></code></a> values (e.g. the column name for <a class="reference internal" href="../API/misc/enum.html#SED.misc.enum.LePhareOutputParam.Z_BEST" title="SED.misc.enum.LePhareOutputParam.Z_BEST"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Z_BEST</span></code></a> parameter is given by <code class="code docutils literal notranslate"><span class="pre">LePhareOutputParam.Z_BEST.name</span></code> which is <code class="code docutils literal notranslate"><span class="pre">'z_best'</span></code>), and with the physical units stored.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Data given as log values in the output parameters file are converted into physical units.</p>
<p>For instance, <a class="reference internal" href="../API/misc/enum.html#SED.misc.enum.LePhareOutputParam.MASS_MED" title="SED.misc.enum.LePhareOutputParam.MASS_MED"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MASS_MED</span></code></a> parameter is given as the decimal logarithm of the median mass in the output file, but the Astropy table gives the median mass.</p>
</div>
<p>Before performing the SED fitting, LePhare must generate a grid of models for the stars, galaxies and QSO. These models are saved into different files located in LePhare directory, so in practice they only need to be generated once, unless one needs a new grids of models.</p>
<p><strong>By default, calling the</strong> <a class="reference internal" href="../API/sed.html#SED.sed.LePhareSED" title="SED.sed.LePhareSED"><code class="xref py py-class docutils literal notranslate"><span class="pre">LePhareSED</span></code></a> <strong>object always generates all of the SED models and compute their magnitudes</strong>. To disable one or more or the SED generation and/or magnitude computation, optional parameters can be passed as</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">params</span>     <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MASS_INF&#39;</span><span class="p">,</span> <span class="s1">&#39;MASS_MED&#39;</span><span class="p">,</span> <span class="s1">&#39;MASS_SUP&#39;</span><span class="p">,</span> <span class="s1">&#39;SFR_INF&#39;</span><span class="p">,</span> <span class="s1">&#39;SFR_MED&#39;</span><span class="p">,</span> <span class="s1">&#39;SFR_SUP&#39;</span><span class="p">]</span>
<span class="n">skipSED</span>    <span class="o">=</span> <span class="kc">True</span> <span class="c1"># Skip SED generation</span>
<span class="n">skipFilter</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># Skip filters generations</span>
<span class="n">skipGal</span>    <span class="o">=</span> <span class="kc">True</span> <span class="c1"># Skip galaxy magnitude computation</span>
<span class="n">skipQSO</span>    <span class="o">=</span> <span class="kc">True</span> <span class="c1"># Skip QSO magnitude computation</span>
<span class="n">skipStar</span>   <span class="o">=</span> <span class="kc">True</span> <span class="c1"># Skip stellar magnitude computation</span>
<span class="n">output</span>     <span class="o">=</span> <span class="n">sed</span><span class="p">(</span><span class="n">catalogue</span><span class="p">,</span> <span class="n">outputParams</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">skipSEDgen</span><span class="o">=</span><span class="n">skipSED</span><span class="p">,</span> <span class="n">skipFilterGen</span><span class="o">=</span><span class="n">skipFilter</span><span class="p">,</span> <span class="n">skipMagQSO</span><span class="o">=</span><span class="n">skipQSO</span><span class="p">,</span> <span class="n">skipMagStar</span><span class="o">=</span><span class="n">skipStar</span><span class="p">,</span> <span class="n">skipMagGal</span><span class="o">=</span><span class="n">skipGal</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="step-4-bis-extract-output-data-from-output-file">
<h2>Step 4-bis: Extract output data from output file<a class="headerlink" href="#step-4-bis-extract-output-data-from-output-file" title="Permalink to this headline">¶</a></h2>
<p>If you had already performed the SED fitting with this library or directly with LePhare and want to load the output parameters again, you can skip the SED fitting step and directly do instead</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">SED</span><span class="o">.</span><span class="n">LePhareOutput</span><span class="p">(</span><span class="s1">&#39;file.out&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="step-5-generate-a-resolved-map">
<h2>Step 5: Generate a resolved map<a class="headerlink" href="#step-5-generate-a-resolved-map" title="Permalink to this headline">¶</a></h2>
<p>Now that we have a <a class="reference internal" href="../API/misc/enum.html#SED.misc.enum.LePhareOutputParam" title="SED.misc.enum.LePhareOutputParam"><code class="xref py py-class docutils literal notranslate"><span class="pre">LePhareOutputParam</span></code></a> object, we can produce a resolved map of any parameter in the Astropy table. The most general way to do this is as follows</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>    <span class="c1"># Shape of the image</span>
<span class="n">sfac</span>  <span class="o">=</span> <span class="mi">100</span>           <span class="c1"># Scale factor used when normalising the input data in FilterList</span>
<span class="n">param</span> <span class="o">=</span> <span class="s1">&#39;mass_med&#39;</span>    <span class="c1"># Column name in the Astropy table (output.table)</span>
<span class="n">mm</span>    <span class="o">=</span> <span class="n">flist</span><span class="o">.</span><span class="n">meanMap</span> <span class="c1"># Mean map used when normalising the input data in FilterList</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">toImage</span><span class="p">(</span><span class="s1">&#39;mass_med&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">scaleFactor</span><span class="o">=</span><span class="n">sfac</span><span class="p">,</span> <span class="n">meanMap</span><span class="o">=</span><span class="n">mm</span><span class="p">)</span>

<span class="n">data</span>  <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">data</span>    <span class="c1"># Data array</span>
<span class="n">unit</span>  <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">unit</span>    <span class="c1"># Data Astropy unit</span>
</pre></div>
</div>
<p>The first parameter is always the column name one wants to generate an image from. The keyword parameters are:</p>
<ul class="simple">
<li><p><strong>shape</strong>: shape of the input and output image</p></li>
<li><p><strong>scaleFactor</strong>: scaling factor used to multiply the data when normalising them</p></li>
<li><p><strong>meanMap</strong>: mean map (spectral average) use to divide the data when normalising</p></li>
</ul>
<p>Since <strong>shape</strong>, <strong>scaleFactor</strong> and <strong>meanMap</strong> are not straightforward to extract from the different objects created above, one can blindly provide them to the <a class="reference internal" href="../API/misc/enum.html#SED.misc.enum.LePhareOutputParam" title="SED.misc.enum.LePhareOutputParam"><code class="xref py py-class docutils literal notranslate"><span class="pre">LePhareOutputParam</span></code></a> object beforehand and then easily call <code class="xref py py-meth docutils literal notranslate"><span class="pre">toImage()</span></code> method as follows</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">output</span><span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="n">filterList</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">toImage</span><span class="p">(</span><span class="s1">&#39;mass_med&#39;</span><span class="p">)</span>
<span class="n">data</span>  <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">data</span>
<span class="n">unit</span>  <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">unit</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The generated output image is an Astropy Quantity, which means it is an array with a physical unit. To only get the data (e.g. for plotting) or the unit one can use the <code class="code docutils literal notranslate"><span class="pre">.data</span></code> and <code class="code docutils literal notranslate"><span class="pre">.unit</span></code> attributes as shown in the examples above.</p>
</div>
</section>
</section>


                        
                    </div>
                </div>
            </div>
        </div>
    </div>    


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.5',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  
    <div class="footer" role="contentinfo">
        <div class="container">
            &#169; Copyright 2021, Wilfried Mercier.
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0.
        </div>
    </div>  

</body>
</html>